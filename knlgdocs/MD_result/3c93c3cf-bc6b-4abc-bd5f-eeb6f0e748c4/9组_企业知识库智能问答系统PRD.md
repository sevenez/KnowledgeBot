# 企业知识库智能问答系统PRD

# 项目概述

目标：面对软件开发公司，主要面相的业务部门为公司总部、产研部、销售部，构建支持多角色权限的智能知识管理系统，集成文档解析、知识图谱、AI问答能力，覆盖公司制度/流程/经营数据三大知识领域。

# 核心价值：

减少 $90 \%$ 基础咨询人力成本

知识检索效率提升 $300 \%$

实现跨系统(OA/CRM/ERP)数据融合 (系统不开发，演示的时候口述思路)

# 1.1.总体架构图

![](images/a01154b3e75080e3038d0b3d114fe2a291ed30afcc8a653c0f2673cb0b8d5877.jpg)  
图1：业务架构图

# 1.2 业务架构

# 分层架构设计（自顶向下）：

# 1．前端层 (用户交互层)

。包含8个模块的前端页面：

。用户登录页面、文档管理页面、知识库管理页面、智能问答页面、知识图谱展示页面、权限／用户管理页面、统计看板页面、系统运维页面。

0核心功能：界面渲染、用户输入处理、图表展示、权限相关UI控制(如隐藏无权限按钮）。

# 2．后端服务层 (业务逻辑层)

# 0按模块划分核心服务：

0认证服务（用户登录、token 管理）；  
。文档处理服务（上传、解析、向量化）；  
。知识库服务（数据集管理、CRUD 操作）；  
。问答服务（RAG 检索、答案生成）；  
0知识图谱服务（实体关系提取、图数据库交互）；  
0权限服务（权限校验、角色管理）；  
0统计服务（数据聚合、指标计算）；  
0运维服务（系统状态监控、模型评估）。

# 3．数据存储层

。关系型数据库：存储用户信息、权限配置、文档元数据、统计日志、系统日志等；  
。向量数据库：存储文档的向量数据（用于RAG 检索）；  
。图数据库：存储知识图谱的实体及关系数据;

。文件存储：保存上传的原始文档（如docx、pdf等）。

# 4．外部集成层 (可选)

。Langfuse平台（低优先级，用于模型持续监控）；  
0RAGAS评估框架（低优先级，用于模型质量量化）。

# 层间交互关系：

前端层 后端服务层：通过API接口交互（如前端调用问答接口获取答案）；）后端服务层 数据存储层：通过数据库驱动/SDK交互（如知识库服务读写向量数据库）；后端服务层内部：服务间调用（如问答服务调用权限服务校验数据访问权限）。

# 1.3业务流程

# 核心流程主线：

# 用户登录 权限验证 核心功能使用 系统监控与统计

# 1．用户登录阶段

0用户通过“用户登录模块”输入账号密码，系统验证身份并分配对应角色权限（Admin／公司／产研组）。0登录成功后，根据权限跳转至系统首页，同时记录登录日志。

# 2．文档与知识库管理阶段

。有权限的用户通过“文档管理模块”上传文件，选择“所属部门”(产研组用户仅限本部门）。  
。上传的文件经解析、向量化处理后，存入“知识库管理模块”形成数据集（关联部门信息）。  
。管理员可通过知识库管理模块维护数据集（增删改查），产研组用户无删除权限。

# 3．智能问答与知识图谱阶段

0用户在“智能问答模块”输入问题，系统调用 RAG 技术：0基于用户权限（部门）检索对应数据集;。结合“知识图谱模块”的实体关系增强答案生成;0返回答案并记录问答日志（用于统计热词、响应时间）。

。知识图谱模块同步从知识库中提取实体关系，构建可视化图谱（受权限控制可见范围）。

# 4．统计与监控阶段

。“统计看板模块”定期汇总各模块数据，生成部门上传趋势、文档类型分布等图表（受权限控制可见范围）。

。“系统运维模块”实时监控数据库、API服务状态及存储空间，管理员可评估模型质量并处理异常。

# 5．权限控制贯穿全流程

。所有操作均需通过“权限管理与用户管理模块”的权限校验:。数据访问范围（如产研组仅限本部门数据集）；。功能使用权限（如产研组无文档删除、权限管理功能）。

# 二、角色权限体系

<table><tr><td>角色</td><td>权限范围</td><td>模型数据集</td></tr><tr><td>系统管理员全系统</td><td></td><td>全</td></tr><tr><td rowspan="3"></td><td>统计看板（整个模块）、智能问答（整个模块）、文</td><td></td></tr><tr><td>企业负责人档处理（整个模块）、知识图谱（整个模块）、权限</td><td>全</td></tr><tr><td>管理 (整个模块）、用户管理 (整个模块)</td><td></td></tr><tr><td rowspan="3"></td><td>统计看板（整个模块）、智能问答（整个模块）、文</td><td>产研组相关</td></tr><tr><td>产研组员工档处理（不含文档删除功能）、知识图谱(整个模</td><td></td></tr><tr><td>块）</td><td>数据集</td></tr></table>

# 三、功能模块设计

# 3.1.用户登录

# 3.1.1功能概述

用户登录模块是企业知识库智能问答系统的入口，负责验证用户身份的合法性，保障系统的安全访问。同时，该模块还提供登录日志审计功能，便于追溯用户的登录行为，以及一系列安全防护机制，提升系统的整体安全性。

# 3.1.2后端功能设计

# 3.1.2.1用户登录与认证服务 (高优先级)

1．功能点描述：实现用户登录功能，提供认证服务，包括密码校验、鉴权以及token 管理。

# 2．业务规则

密码校验：系统需准确核对用户输入的密码与数据库中存储的加密密码是否一致。

·鉴权：在用户密码校验通过后，根据用户的角色信息授予相应的系统访问权限。

token管理：为通过认证的用户生成唯一的token，作为用户在系统中进行后续操作的身份凭证。token具有一定的有效期，过期后用户需重新登录获取新的 token。

# 3．测试要点

正常场景：使用正确的用户名和密码登录，验证是否能成功获取token并进入系统。

，异常场景：输入错误的用户名或密码，检查系统是否能正确提示认证失败；使用已过期的token进行操作，验证系统是否能拒绝访问并提示重新登录。

边界条件：无特殊边界条件。

# 3.1.2.2用户登录与认证服务 (中优先级)

1．功能点描述：记录登录用户的用户名以及登录时间。

2．业务规则：每当有用户登录系统（无论登录成功与否），系统都需自动记录该用户的用户名和登录时间，存储到登录日志数据库中。

# 3．测试要点

正常场景：用户成功登录后，检查登录日志中是否准确记录了用户名和登录时间；用户登录失败时，同样检查日志记录情况。

·异常场景：模拟系统故障导致登录过程中断，查看是否仍能记录相关日志信息。

·边界条件：在同一时间有多个用户同时登录，验证日志记录是否准确无误，无遗漏或重复记录。

3.1.2.3登录日志审计-记录登录设备、IP、异地登录检测及安全防护（低优先级)

1．功能点描述：记录用户登录所使用的设备信息、IP地址，进行异地登录检测，对于后台用户采用更严格的验证机制，并提供安全防护功能。

# 2．业务规则

，登录设备及IP记录：系统需获取并记录用户登录时的设备型号、操作系统等设备信息以及IP 地址。

异地登录检测：根据用户历史登录的IP地址所属地区，判断当前登录是否为异地登录。若检测到异地登录，对于普通用户，系统可进行提示；对于后台用户，除提示外，还需进行更严格的验证，如额外的验证码验证或安全问题验证。

，安全防护：针对可能的恶意登录行为，如短时间内多次从同一IP 地址尝试登录不同账户等，系统可采取临时封禁IP等安全防护措施。

# 3．测试要点

正常场景：用户在常用地点使用常用设备登录，检查设备信息、IP地址是否记录正确；在异地使用新设备登录，验证是否能准确检测并进行相应提示或验证。

：异常场景：模拟使用虚假的设备信息和IP地址进行登录，查看系统是否能正常记录并进行异地登录检测。

，边界条件：用户的登录IP地址处于两个地区的边界，验证异地登录检测的准确性。

# 3.1.2.4记住密码、登录失败锁定及密码复杂度校验 (低优先级)

1．功能点描述：提供记住密码功能，当用户连续5次登录失败时锁定账户，同时对用户设置的密码进行复杂度校验，要求包含大小写字母和特殊字符，长度在8-16 位之间。

# 2．业务规则

记住密码：用户勾选“记住密码”选项并成功登录后，系统在一定时间内（可配置）保存用户的登录信息，下次用户访问系统时自动填充用户名和密码。

：登录失败锁定：当用户连续5次输入错误密码登录失败后，系统自动锁定该账户，锁定时间可配置（如30分钟），锁定期间不允许该账户进行登录操作。

密码复杂度校验：用户在设置或修改密码时，系统需校验密码是否满足包含大小写字母、特殊字符以及长度在8-16 位的要求，不满足则提示用户密码不符合规范。

# 3．测试要点

，正常场景：用户勾选“记住密码”后成功登录，关闭浏览器再重新打开系统，检查是否能自动填充用户名和密码；用户连续4次登录失败后，第5次输入正确密码，验证是否能成功登录；设置符合复杂度要求的密码，检查是否能通过

校验。

，异常场景：用户连续5次登录失败，尝试第6次登录，验证账户是否处于锁定状态；设置不满足复杂度要求的密码（如长度不足、缺少特殊字符等），检查系统是否能正确提示。

·边界条件：设置密码长度为8位和16位，验证是否符合要求；在账户锁定即将解除时（如锁定30分钟，在第29分钟59秒）尝试登录，检查是否仍处于锁定状态。

# 3.1.3前端功能设计

# 3.1.3.1记住密码、登录失败锁定及密码复杂度校验 (低优先级)

1．功能点描述：提供标准的用户名密码登录对话框形式的登录页面，背景色为RGB（129,211,248），字体字符和颜色可自行设置。

2．交互逻辑：用户在登录页面输入用户名和密码后，点击登录按钮，前端将用户输入的信息发送至后端进行认证。若认证通过，跳转至系统首页；若认证失败，显示相应的错误提示信息。

# 3．测试要点

：页面布局：检查登录页面是否为标准的用户名密码登录对话框形式，背景色是否准确为 RGB（129,211,248）。

·交互操作：在登录页面输入正确的用户名和密码并点击登录，验证是否能成功

跳转至系统首页；输入错误信息登录，检查是否显示错误提示。

·兼容性：在不同的浏览器（如Chrome、Firefox、Edge 等）和不同分辨率的设备上打开登录页面，验证页面显示是否正常，功能是否可用。

# 3.1.3.2各类提示对话框 (低优先级)

1．功能点描述：包括登录失败对话框、记住密码对话框、密码过于简单对话框、账户锁定对话框。

# 2．交互逻辑

登录失败对话框：当用户登录认证失败时，自动弹出该对话框，提示用户登录失败的原因（如用户名或密码错误等），用户点击确定后关闭对话框，可重新输入信息登录。

记住密码对话框：当用户勾选“记住密码”选项时，若系统需要进行确认，弹出该对话框，用户点击确认则保存密码，点击取消则不保存。

密码过于简单对话框：当用户设置的密码不满足复杂度要求时，弹出该对话框，提示用户密码过于简单及具体的要求，用户点击确定后可重新设置密码。

，账户锁定对话框：当用户的账户因连续登录失败被锁定时，弹出该对话框，提示用户账户已锁定及锁定时间，用户点击确定后关闭对话框。

# 3．测试要点

·触发条件：模拟各种触发场景（如登录失败、设置简单密码等），检查相应的对话框是否能正确弹出。

内容与交互：查看对话框中的提示信息是否准确、清晰；点击对话框中的按钮(如确定、取消），验证是否能执行相应的操作（如关闭对话框、重新设置密码等）。

·样式：检查各类对话框的样式是否统一、美观，与系统整体风格是否协调。

# 3.2.文档管理

# 3.2.1功能概述

文档管理模块是企业知识库智能问答系统的核心数据入口，负责文件的上传、解析、存储、管理及测试功能。通过支持多种文件格式、严格的权限区分（基于所属部门）和完善的台账管理，实现企业知识资源的规范化录入与维护，为后续智能问答提供高质量的数据基础。

# 3.2.2后端功能设计

# 3.2.2.1文件上传 (高优先级)

1.\*\*功能点描述\*\*支持接收用户上传的'txt、pdf、docx、csv、markdown\`格式文件，单个文件大小  
限制为15MB。

# 2.\*\*业务规则\*\*

-上传文件时需校验格式，仅允许指定的5种格式通过;

-校验文件大小，超过15MB的文件直接拒绝上传;

-需关联文件所属部门信息（由前端传入），用于后续权限控制。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-上传5种支持格式的文件（每种格式各1个，大小均≤15MB），验证是否上传成功；

-上传同一文件（如 test.pdf）到不同部门，验证系统是否分别存储并关联正确部门。

-\*\*异常场景\*\*:

-上传非支持格式文件（如.exe、.zip），验证是否提示"不支持的文件格式";

-上传16MB的pdf文件，验证是否提示"文件大小超过15MB 限制";

-上传空文件（0字节的txt），验证是否提示"文件内容不能为空"。

-\*\*边界条件\*\*:

-上传恰好15MB的docx文件，验证是否正常接收。

# 3.2.2.2文件上传 (低优先级)

# 1.\*\*功能点描述\*\*

扩展支持\`MDX、HTML、XLSX、XLS、VTT、PROPERTIESMD、HTM\`格式文件，大小限制同高优先级规则（15MB）。

# 2.\*\*业务规则\*\*

-新增格式与原有格式共用一套大小校验逻辑;

-解析逻辑需单独开发（见"文档解析-低优先级"）。

# 3.\*\*测试要点\*\*

-参照"高优先级文件上传"的测试方法，对7种新增格式文件进行同样场景测试;-混合上传高优先级和低优先级格式文件（如同时上传pdf和xlsx），验证是否均能正确处理。

# 3.2.2.3文件接收服务 (高优先级)

# 1.\*\*功能点描述\*\*

提供文件分片接收API、分片临时存储、文件合并API，并在合并完成后自动触发文档解析流程。 (文件分片上传低优先级)

# 2.\*\*业务规则\*\*

-大文件（建议≥5MB）自动触发分片上传，分片大小默认1MB（可配置）；

-分片文件临时存储在系统指定目录，合并成功后自动删除临时文件;

-合并失败时，保留临时文件24小时（用于问题排查），超时自动清理。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-上传6MB的pdf文件（触发分片，分为6个1MB分片），验证是否能正确合并为原文件；

-合并完成后，检查临时目录是否已清空，且文档解析流程是否自动启动。

-\*\*异常场景\*\*:

-模拟分片传输过程中网络中断（如传输第3个分片时断开连接），重新连接后验证是否能续传剩余分片；

-人为篡改某一分片内容，验证合并时是否提示"文件损坏"并拒绝生成最终文件。

-\*\*边界条件\*\*:

-上传恰好5MB的文件，验证是否触发分片上传。

# 3.2.2.4文档解析-预处理 (高优先级)

1.\*\*功能点描述\*\*自动提取上传文件的文本内容，去除页眉、页脚、页码等无关信息，清理特殊字符(如不可见控制字符、乱码符号）。

# 2.\*\*业务规则\*\*

-针对pdf、docx等格式，需识别并剔除固定位置的页眉页脚（如每页顶部的公司名称、底部的页码）；

-统一文本编码为UTF-8，去除所有非打印字符（如ASCII码0-31的控制字符）。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-上传带页眉（"企业知识库"）、页脚（"第×页"）的pdf文件，验证提取的文本中是否已剔除这些内容；

-上传含特殊字符（如换行符、制表符、emoji）的doc×文件，验证是否保留有效内容且无乱码。

-\*\*异常场景\*\*:

-上传扫描版pdf (图片内容），验证是否提示"无法提取文本（非可编辑文档）";

-上传纯乱码的 txt文件，验证是否提示"文本内容无效"。

# 3.2.2.5 文档解析-预处理 (低优先级)

# 1.\*\*功能点描述\*\*

针对"低优先级文件上传"中新增的格式（如XLSX、HTML），开发专用解析器，并根据文件扩展名自动路由到对应解析器。

# 2.\*\*业务规则\*\*

-建立扩展名与解析器的映射表（如.xlsx→Excel解析器，.html→HTML解析器）；

-解析器需提取文件中的结构化内容（如 Excel的单元格文本、HTML的正文标签内容）。

# 3.\*\*测试要点\*\*

-上传XLSX文件（含多sheet页），验证是否能提取所有 sheet中的文本内容;-上传HTML文件（含标签、脚本、样式），验证是否仅提取<body>\`中的正文文本，忽略标签和脚本。

# 3.2.2.6 文档解析-向量化 (高优先级)

# 1.\*\*功能点描述\*\*

将预处理后的文本进行向量化处理：采用中文BERT模型进行分词与编码，提取任务、

角色等命名实体，通过Milvus向量数据库将文本转化为向量表示，最终存入向量库。

# 2.\*\*业务规则\*\*

-文本编码统一为UTF-8，确保中文分词准确性;

-向量维度需与系统后续检索模型兼容（默认768维）；

-向量与原文件信息（文件名、部门、创建时间）关联存储。

# 3.\*\*测试要点\*\*

-上传含中文、英文、数字混合的文本（如"2023年企业AI项目计划"），验证分词结果是否准确(如"企业AI项目"被正确拆分）；

-随机抽取10个文件，检查向量库中是否存在对应的向量记录，且与文件信息关联正确。

# 3.2.2.7召回测试 (低优先级)

# 1.\*\*功能点描述\*\*

提供接口支持将用户输入的问题向量化，并通过关键词检索从向量库中召回相关文本段落。

# 2.\*\*业务规则\*\*

-问题向量化逻辑与文档向量化保持一致（同中文BERT模型）；  
-检索结果按相似度排序，返回前10条最相关的段落。

# 3.\*\*测试要点\*\*

-针对已知内容的文件（如含"产品定价策略"的文档），输入关键词"产品价格怎么定"，验证是否能召回该段落；

-输入无相关内容的关键词 (如"9 组牛逼大无敌"），验证是否返回"未找到相关结果"。

# 3.2.2.8 文档删除逻辑 (高优先级)

# 1.\*\*功能点描述\*\*

支持删除指定文档，同时清理该文档关联的所有数据(包括原文件、预处理文本、向量库记录、台账信息）。

# 2.\*\*业务规则\*\*

-删除操作需校验用户权限（仅允许删除本部门或有权限部门的文档）；  
-执行删除后，所有关联数据不可恢复（物理删除）。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-删除某文档后，检查台账中是否已移除该记录，原文件存储目录、向量库中是否已无对应数据。

# -\*\*异常场景\*\*:

-使用无权限的用户（如A部门用户删除B部门文档），验证是否提示"无删除权限"；

-删除已被智能问答模块引用的文档，验证问答功能是否会自动过滤该文档的内容。

# 3.2.2.9 文档管理台账页接口 (高优先级)

# 1.\*\*功能点描述\*\*

提供台账的增删改查接口，支持前端调用"文档上传""文档删除""召回测试"等功能按钮的触发逻辑。

# 2.\*\*业务规则\*\*

-台账数据需实时更新 (如文件上传成功后立即新增记录，状态从"索引中"变为"可用"时自动刷新）；

-支持按"文件名称、所属部门、创建时间"筛选查询，查询结果分页返回（默认每页20条）。

# 3.\*\*测试要点\*\*

-调用查询接口时传入不同筛选条件（如部门=技术部，创建时间=2024-08），验证返回结果是否准确；

-连续上传100个文件，验证台账分页功能是否正常（第1页显示前20条，第2页显示21-40条）。

# 3.2.3前端功能设计

# 3.2.3.1文件上传基础页面 (高优先级)

# 1.\*\*功能点描述\*\*

包含文档管理台账列表、操作按钮（文档上传、文档删除、召回测试）及查询功能,页面布局与原型一致。

# 2.\*\*台账列表字段\*\*

-序号：自动递增的数字（1,2,3...）；

-文件名称：显示上传文件的原始名称（含扩展名）；

-所属部门：显示文件关联的部门（如"产研部"）；

-字符数：预处理后的文本字符总数;

-创建时间：文件上传成功的时间（格式：YYYY-MM-DD HH:MM:SS）;

-状态："索引中"（解析或向量化未完成）/"可用"（可用于智能问答）；

-创建人：上传文件的用户名;

-备注：用户上传时填写的备注信息（可选）。

# 3.\*\*交互逻辑\*\*

-\*\*文档上传\*\*:

1.点击"文档上传"按钮，弹出上传页面;

2.先选择"所属部门"（下拉选择框，仅显示当前用户有权限的部门）；

3.支持两种上传方式：点击"选择文件"按钮通过文件路径选择，或直接拖拽文件到指定区域；

4.点击"下一步"，显示上传进度条（中优先级功能）；

5.上传成功后显示"上传成功"提示，点击"确认"返回台账页，台账自动刷新显示新文件。

-\*\*查询功能\*\*:

1.页面顶部提供3个查询条件：文件名称（输入框，支持模糊匹配）、所属部门（下拉选择框）、创建时间（日期范围选择器）；

2.输入条件后点击"查询"按钮，台账列表实时显示筛选结果;

3.点击"重置"按钮，清空所有条件并显示全部文件。

# 4.\*\*测试要点\*\*

-\*\*页面布局\*\*:

-检查台账列表是否显示所有要求的字段，字段顺序与原型一致;

-检查查询条件是否包含"文件名称、所属部门、创建时间"，且控件类型正确（输入框、下拉框、日期选择器）。

-\*\*交互操作\*\*:

-测试文件上传的完整流程（选部门 选文件 下一步 确认），验证是否能成功上传并在台账显示;

-测试拖拽上传功能（将文件从桌面拖拽到上传区域），验证是否与点击上传效果一致；

-输入不同查询条件(如文件名称含"产品"、部门 $\vDash$ 产研部），验证台账是否显示正确结果;

-\*\*权限控制\*\*:

-使用“产研部”部门用户登录，验证"所属部门"下拉框中是否仅显示“产研部”。

# 3.2.3.2文件上传进度条 (中优先级)

# 1.\*\*功能点描述\*\*

在文件上传过程中显示进度条，按照文件上传的进度，异步实时展示上传进度（百分比）。

# 2.\*\*交互逻辑\*\*

-点击"下一步"后，进度条从 $0 \%$ 开始增长，直至 $1 0 0 \%$ ·，-进度条下方显示实时状态 (如"上传中...""已上传 $5 0 \% " .$ ）；-上传失败时，进度条变为红色并显示失败原因（如"网络中断，请重试"）。

# 3.\*\*测试要点\*\*

-上传10MB文件，观察进度条是否从 $0 \%$ 平滑增长到 $100 \%$ ，且百分比与实际上传 进度一致;

-上传过程中断开网络，验证进度条是否显示红色并提示失败原因。

# 3.2.3.3召回测试页面 (低优先级)

# 1.\*\*功能点描述\*\*

支持用户输入关键词，测试指定文件的召回效果，右侧显示召回段落并高亮关键词。

# 2.\*\*交互逻辑\*\*

-在台账列表中选中1个文件，点击"召回测试"按钮，跳转至测试页面;  
-页面左侧为输入框 (提示"请输入测试关键词"）和"测试"按钮;  
-点击"测试"后，右侧空白区域显示召回的文本段落，关键词以黄色背景高亮;  
-点击"返回"按钮，回到台账页。

# 3.\*\*测试要点\*\*

-选中某文件并输入该文件中的关键词(如文件含"人工智能"，输入"人工"），验证右侧是否显示包含该关键词的段落，且"人工"是否被高亮;-输入文件中不存在的关键词，验证右侧是否显示"未找到相关段落"。

# 3.2.3.4文档删除 (高优先级)

1.\*\*功能点描述\*\*

支持从台账中删除选中的文件，流程与原型一致。

# 2.\*\*交互逻辑\*\*

-在台账列表中勾选1个或多个文件，点击"文档删除"按钮;

-弹出确认对话框（内容："确定要删除选中的×个文件吗？删除后不可恢复。"）；

-点击"确认删除"，系统执行删除操作;

-删除完成后弹出提示"删除成功"，点击"完成"，台账自动刷新 (已删除文件不再显示）。

# 3.\*\*测试要点\*\*

-勾选1个文件执行删除流程，验证是否从台账中移除;  
-同时勾选5个文件执行删除，验证是否批量删除成功;  
-点击"删除"后再点击对话框的"取消"按钮，验证文件是否未被删除;  
-使用无权限用户删除其他部门文件，验证是否提示"无权限删除该文件"。

# 3.2.3.5 文档管理台账页 (高优先级)

1.\*\*功能点描述\*\*

整合台账列表、操作按钮、查询功能的完整页面，与原型样式一致。

# 2.\*\*交互逻辑\*\*

-页面加载时自动调用接口获取全量文件数据（受用户权限限制）；

-支持台账列表排序 (点击表头字段可按该字段升序/降序排列，如点击"创建时间"按时间倒序）；

-当文件状态为"索引中"时，该记录行显示灰色字体，且"召回测试"按钮不可点击。

# 3.\*\*测试要点\*\*

-页面加载完成后，验证是否自动显示用户有权限的所有文件;  
-点击表头"文件名称"，验证列表是否按名称首字母排序（A-Z或Z-A）；  
-观察状态为"索引中"的文件，验证是否显示灰色字体且"召回测试"按钮不可点击。

# 3.3.知识库管理

# 3.3.1功能概述

知识库管理模块用于实现企业知识的结构化组织与管理，支持创建多个独立的知识库容器，每个知识库可关联多个文档资源。通过部门权限隔离及完整的文档操作流程，实现知识资源的规范化分类与维护，为智能问答提供精准的知识单元支持。

# 3.3.2后端功能设计

# 3.3.2.1知识库管理台账页 (高优先级)

# 1.\*\*功能点描述\*\*

提供知识库的增删改查接口支持，实现知识库详情页展示，支持通过台账中的知识库名称跳转至对应权限范围内的知识库详情管理页面。

# 2.\*\*业务规则\*\*

-台账数据需按用户所属部门权限过滤，仅展示用户有权访问的知识库；-知识库详情页需关联展示其包含的所有文档列表（受文档所属部门权限控制）；-支持按"知识库名称、所属部门、创建时间、状态"进行筛选查询，结果分页返回(默认每页20条）。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-调用查询接口时传入不同筛选条件（如部门=产研部），验证返回结果准确性;

-点击台账中的知识库名称，验证是否跳转至该知识库的详情页且仅显示有权限的内容。

# -\*\*异常场景\*\*:

-使用无权限用户调用接口查询其他部门知识库，验证是否返回空结果或无权限提示；

-传入不存在的知识库名称请求详情页，验证是否返回"知识库不存在"提示。

-\*\*边界条件\*\*:

-系统中存在100个知识库，验证分页功能是否正常（第5页显示41-50条）。

# 3.3.2.2知识库创建 (高优先级)

1.\*\*功能点描述\*\*

提供知识库创建的SQL脚本及接口，支持录入知识库基本信息（名称、所属部门、备注等）。

# 2.\*\*业务规则\*\*

-知识库名称为必填项，且在同一部门内不可重复；  
-新建知识库默认状态为"生效";  
-知识库创建者自动成为该知识库的管理员，拥有全部操作权限。-建议未上传文件的知识库也允许发布。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:-录入唯一名称、选择部门并提交，验证是否创建成功且状态为"生效";-检查数据库中是否生成对应的知识库记录，且创建人信息正确。

-\*\*异常场景\*\*:

-输入已存在的知识库名称 （同一部门），验证是否提示"该部门已存在同名知识库";

-不填写知识库名称直接提交，验证是否提示"名称为必填项"。

# 3.3.2.3 添加文档 (高优先级)

# 1.\*\*功能点描述\*\*

支持向指定知识库添加文档，文件格式包括'txt、pdf、docx、csv、markdown',单个文件大小限制15MB。

# 2.\*\*业务规则\*\*

-文档所属部门需与目标知识库的所属部门一致（或存在权限关联）；  
-文档添加后自动触发解析与向量化流程（同文档管理模块逻辑）；  
-文档与知识库形成多对一关联关系，支持一个文档关联至多个有权限的知识库。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-向"技术部-产品手册"知识库添加10MB的pdf文件，验证是否添加成功且在该知 识库文档列表中显示;

-检查文档解析后是否正确关联至该知识库。

-\*\*异常场景\*\*:

-向技术部知识库添加归属为市场部的文档，验证是否提示"部门不匹配，无法添加";  
-添加超过15MB 的文件，验证是否提示"文件大小超限"。

# 3.3.2.4 添加文档 (低优先级)

# 1.\*\*功能点描述\*\*

扩展支持向知识库添加\`MDX、HTML、XLSX、XLS、VTT、PROPERTIESMD、HTM\`格式文件，大小限制15MB。

# 2.\*\*业务规则\*\*

-与高优先级格式共用同一套权限校验与关联逻辑;  
-解析逻辑需适配新增格式（同文档管理模块低优先级解析规则）。

# 3.\*\*测试要点\*\*

-参照高优先级添加文档的测试方法，对7种新增格式文件进行同等测试;  
-验证新增格式文档是否正确关联至目标知识库。

# 3.3.2.5 文件接收服务 (高优先级)

# 1.\*\*功能点描述\*\*

提供与文档管理模块一致的文件分片接收、临时存储、合并及后续流程触发服务，专门用于知识库的文档上传场景。

# 2.\*\*业务规则\*\*

-分片逻辑、临时存储策略与文档管理模块保持一致;

-合并完成后除触发解析流程外，额外触发"文档-知识库"关联关系建立。

# 3.\*\*测试要点\*\*

-参照文档管理模块中文件接收服务的测试场景，验证分片上传、合并及流程触发的正确性；

-重点测试合并完成后，文档是否成功关联至目标知识库。

# 3.3.2.6 文档解析 (高优先级)

1.\*\*功能点描述\*\*

与文档管理模块共享解析逻辑，包括文本提取（去除页眉页脚等）、特殊字符清理及向量化处理（中文BERT分词、Milvus向量转换）。

# 2.\*\*业务规则\*\*

-解析流程与文档管理模块完全一致，确保数据处理标准统一;

-向量化结果需同时关联文档ID与知识库ID，支持按知识库维度检索。

# 3.\*\*测试要点\*\*

-参照文档管理模块中文档解析的测试方法，验证文本提取与向量化的准确性;  
-检查向量库中是否同时存储文档与知识库的关联关系。

# 3.3.2.7文档解析 (低优先级)

# 1.\*\*功能点描述\*\*

针对低优先级格式文件（如XLSX、HTML等）提供专用解析器，实现与高优先级格式一致的解析效果。

# 2.\*\*业务规则\*\*

-解析逻辑与文档管理模块低优先级解析规则一致;

-解析结果需正确关联至目标知识库。

# 3.\*\*测试要点\*\*

-参照文档管理模块中低优先级解析的测试场景，验证新增格式的解析效果;  
-确认解析后的文本与向量数据正确关联至对应知识库。

# 3.3.2.8 文档删除 (高优先级)

1.\*\*功能点描述\*\*

支持从指定知识库中移除文档，或彻底删除文档（同时从所有关联知识库中移除）。(请开发选定)

# 2.\*\*业务规则\*\*

-"从知识库移除"仅解除文档与该知识库的关联关系，文档实体仍存在于系统中;-"彻底删除"需校验用户是否拥有该文档的删除权限，删除后所有关联关系及数据(原文件、向量等）一并清除。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-从知识库中移除文档后，验证该知识库文档列表中已无此文档，但其他关联知识库仍可查看；

-执行彻底删除后，验证所有关联知识库均无法查看该文档，且原文件存储路径已清空。

-\*\*异常场景\*\*:

-尝试从知识库中移除不存在的文档，验证是否提示"文档不存在";

-无权限用户执行彻底删除，验证是否提示"无删除权限"。

# 3.3.2.9 知识库发布 (高优先级)

1.\*\*功能点描述\*\*

提供知识库发布的SQL脚本及接口，发布知识库。

# 2.\*\*业务规则\*\*

-发布前需校验知识库中至少包含1个文档，否则不允许发布;

-发布后知识库内容（文档及关联向量）进入检索池，可被智能问答模块调用;

-已发布的知识库支持再次编辑，编辑完成后需重新发布。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:-创建中的知识库执行发布操作，验证是否提示"至少需添加1个文档才能发布。

# 3.3.2.10 知识库删除 (高优先级)

# 1.\*\*功能点描述\*\*

提供知识库删除的SQL脚本及接口，支持删除指定知识库，\*\*删除时将同时删除该知识库包含的所有文档\*\*（包括文档实体、关联关系及向量数据）。

2.\*\*业务规则\*\*

-删除前需校验用户权限（仅创建者或系统管理员可删除）。

-若知识库里包含文档，删除前需向用户展示提醒（"当前知识库包含×个文档，删除后将一并永久删除这些文档，且不可恢复。是否确认？"）；

-用户确认后，执行级联删除：

-移除知识库实体记录;

-删除该知识库关联的所有文档（包括原文件、预处理文本、向量库记录）；

-清理所有相关的权限关联数据。

# 3.\*\*测试要点\*\*

# -\*\*正常场景\*\*:

-对包含3个文档的知识库执行删除：验证系统是否显示包含文档数量的提醒 用户确认后，检查知识库是否从台账移除，且3个文档是否从系统中彻底删除（在任何模块均无法查询）；

-\*\*异常场景\*\*:

-非创建者且非管理员执行删除操作：验证是否提示"无删除权限";

-删除过程中系统断电重启：重新启动后检查知识库及文档是否处于一致状态(要么都存在，要么都删除，不允许部分删除）。

# -\*\*边界条件\*\*:

-知识库中包含100个文档（总大小500MB），执行删除后验证是否能彻底清理所有文件及数据库记录，无残留数据。

# 3.3.3前端功能设计

# 3.3.3.1知识库管理台账页 (高优先级)

# 1.\*\*功能点描述\*\*

展示知识库台账列表及操作按钮，支持知识库的查询、创建、删除及文档添加操作，页面布局与原型一致。

# 2.\*\*台账列表字段\*\*

-序号：自动递增数字（1,2,3...）；

-知识库名称：点击可跳转至该知识库详情页;

-所属部门：知识库归属的部门(如"技术部""市场部"）；

-文件数：该知识库包含的文档总数;

-创建时间：知识库创建的时间（格式：YYYY-MM-DD HH:MM:SS）；

-状态："未生效"（未发布）/"生效"（已发布）；

-创建人：知识库创建者的用户名；

-备注：创建时填写的备注信息（可选）。

# 3.\*\*交互逻辑\*\*

-\*\*操作按钮\*\*:

-"添加文件"：选中单个知识库后可点击，弹出文件上传页面（见"添加文档"功能）；

-"知识库创建"：点击跳转至知识库创建页;

-"知识库删除"：勾选一个或多个知识库后可点击，触发删除确认流程。

-\*\*查询功能\*\*:

-支持按"知识库名称（模糊匹配）、所属部门（下拉选择）、创建时间（日期范

围）、状态（下拉选择：全部/未生效/生效）"筛选;

-点击"查询"按钮刷新列表，"重置"按钮清空条件并显示全部。

# 4.\*\*测试要点\*\*

-\*\*页面布局\*\*:

-检查台账字段是否完整，与原型一致;

-验证"添加文件"按钮是否仅在选中单个知识库时可点击。

-\*\*交互操作\*\*:

-测试查询功能：输入不同条件组合 （如名称含"产品"、状态 $\mathbf { \Sigma } =$ 生效），验证列表筛选结果是否正确；

-点击知识库名称，验证是否跳转至该知识库的详情页;

-测试"重置"按钮是否能清空所有查询条件。

-\*\*权限控制\*\*:-使用产研部用户登录，验证是否只能看到产研部及有权限的知识库。

# 3.3.3.2 添加文档 (高优先级)

1.\*\*功能点描述\*\*

提供与文档管理模块一致的文件上传页面，支持向选中的知识库添加文档。

2.\*\*交互逻辑\*\*

-选中知识库后点击"添加文件"，弹出上传页面;

-页面默认带入目标知识库的所属部门（不可修改）；

-支持点击选择文件或拖拽上传，文件格式限制与后端一致;

-点击"下一步"显示进度条（中优先级），上传成功后提示"添加成功"，确认后返回台账页并刷新。

# 3.\*\*测试要点\*\*

-完整测试添加流程：选中知识库 $ .$ 上传文件 完成，验证文档是否成功添加至该知识库；

-验证上传页面是否默认锁定所属部门，且与目标知识库部门一致;  
-测试上传不支持的格式（如.exe），验证是否提示"不支持的文件格式"。

# 3.3.3.3文件上传进度条 (中优先级)

1.\*\*功能点描述\*\*

在向知识库添加文档时显示上传进度，样式与文档管理模块一致。

# 2.\*\*交互逻辑\*\*

-进度条实时展示上传百分比，支持取消上传（点击"取消"按钮终止流程）；

-上传失败时显示错误原因 (如"网络错误"），并提供"重试"按钮。

# 3.\*\*测试要点\*\*

-上传5MB文件，观察进度条是否从 $0 \%$ 平滑增长至 $100 \%$ ·

-上传过程中点击"取消"，验证是否终止上传且不保留临时文件。

# 3.3.3.4知识库创建 (高优先级)

1.\*\*功能点描述\*\*

提供知识库创建页面，支持录入基本信息并添加初始文档。

# 2.\*\*交互逻辑\*\*

-点击"知识库创建"按钮，跳转至创建页;

-页面包含：

-基本信息区：知识库名称输入框（必填）、所属部门下拉框（必填）、备注输入框；

-文档操作区："文档上传"按钮、"文档删除"按钮;

-文档台账列表：显示当前添加的文档（字段同文档管理模块台账）；

－知识库发布按钮（点击发布按钮填写信息 上传文档 知识库发布，直接发布为生效状态）。

-点击"文档上传"按钮，弹出与"添加文档"一致的上传页面，上传的文档自动显示在 当前知识库的文档台账中;

-点击"文档上传"按钮，弹出与"添加文档"一致的上传页面，上传的文档自动显示在 当前知识库的文档台账中;

# 3.\*\*测试要点\*\*

-完整测试创建流程：填写信息 $ .$ 上传文档 知识库发布，验证是否成功创建且状态正确；

-测试"知识库发布"按钮：验证知识库是否能成功发布;

-测试文档删除：在创建页上传文档后点击"文档删除"，验证是否从当前知识库文档列表中移除。

# 3.3.3.5知识库删除 (高优先级)

# 1.\*\*功能点描述\*\*

支持从台账中删除选中的知识库，\*\*删除时级联删除知识库包含的所有文档\*\*，流程按更新后逻辑执行。

# 2.\*\*交互逻辑\*\*

-勾选一个或多个知识库，点击"知识库删除"按钮;

-按以下逻辑显示确认框：

-若为\*\*空知识库\*\*：弹出确认框（内容："确定删除选中的×个空知识库吗？删除后不可恢复。"）；

-若为\*\*包含文档的知识库\*\*：弹出确认框（内容："选中的×个知识库中，有丫个

包含文档（共Z个文档）。删除后将一并永久删除这些文档，且不可恢复。是否确认？"）；

-点击"确认删除"，系统执行级联删除；完成后提示"删除成功，共删除×个知识库及Z个文档";

-点击"完成"，台账自动刷新（已删除知识库不再显示）。

# 3.\*\*测试要点\*\*

-\*\*含文档的知识库删除\*\*：

-勾选1个包含5个文档的知识库，点击删除 验证确认框是否正确显示文档数量→确认后，检查台账中知识库是否移除，且文档管理模块中也无法查询到这5个文档;

-\*\*空知识库删除\*\*：

-勾选1个空知识库，点击删除 验证确认框是否显示"空知识库"提示 确认后，检 查台账是否移除该知识库;

-\*\*混合删除\*\*:

-同时勾选1个含文档的知识库和1个空知识库 验证确认框是否汇总显示"共×个知识库，Y个包含文档（共Z个）"→确认后，检查是否全部删除;

-\*\*权限与状态校验\*\*:

-勾选1个已生效未下架的知识库 验证是否提示"请先下架";  
-使用无权限用户删除 验证是否提示"无删除权限"。

# 3.4.智能问答

# 3.4.1功能概述

智能问答模块是企业知识库智能问答系统的核心交互模块，基于文档管理和知识库管理模块上传并解析形成的知识库，利用RAG（检索增强生成）技术，为用户提供准确、相关的问答服务。用户通过前端界面输入问题，系统检索相关文档片段并生成答案返回，同时记录问答日志用于统计分析。

# 3.4.2后端功能设计

# 3.4.2.1智能问答 (高优先级)

1．功能点描述：实现用户问题的接收、处理、答案生成及返回功能。具体包括用户在界面输入问题后，系统运用RAG技术检索相关文档片段，结合这些片段生成答案并返回给用户，同时完成问答接口和答案生成器的开发。

# 2．业务规则

问题接收：系统需能准确接收前端传递的用户问题文本，支持常见的中文输入字符。

，检索环节：基于用户问题，利用 RAG技术从已解析形成的知识库中检索相关度最高的文档片段，检索范围限定在用户有权限访问的知识库内。

答案生成：答案生成器需结合检索到的文档片段，生成自然、准确、简洁的回答，确保答案基于知识库内容，不编造信息。

·接口规范：问答接口需定义清晰的请求参数（如用户ID、问题文本等）和响应格式（如答案内容、相关文档片段标识等），保证前后端交互顺畅。

# 3．测试要点

正常场景：用户输入与知识库内容相关的问题（如“产品A的定价是多少”，且知识库中有相关文档），验证系统是否能检索到正确的文档片段并生成准确的答案；不同用户（拥有不同权限）输入相同问题，验证返回的答案是否符合其权限范围（只能基于其可访问的知识库内容生成答案）。

异常场景：用户输入无意义的乱码字符，检查系统是否能提示“请输入有效的问题”；用户输入的问题在知识库中无相关内容，验证系统是否能返回“未找到相关信息”等提示；模拟前端传递错误的请求参数（如缺少用户ID），检查接口是否能返回合适的错误码和提示信息。

，边界条件：用户输入超长问题（如超过1000字），验证系统是否能正常处理并返回答案；同时有多个用户发送请求，检查系统的并发处理能力和响应是否正常。

# 3.4.2.2 日志统计 (中优先级)

1．功能点描述：记录智能问答过程中的相关日志，统计热词、响应时间等信息，并将这些数据存储到关系型数据库中。

# 2．业务规则

日志记录：需记录的日志信息包括用户ID、用户名、提问时间、问题文本、答案内容、相关文档片段标识、响应时间等。

，热词统计：定期（如每天）对用户的问题文本进行分析，提取出现频率较高的词汇作为热词，统计其出现次数。

响应时间统计：记录每个问题从接收至返回答案的时间，计算平均响应时间、最长响应时间、最短响应时间等指标。

数据存储：所有日志和统计数据需按照规范的格式存储到关系型数据库中，确保数据的完整性和一致性，便于后续查询和分析。

# 3．测试要点

正常场景：用户进行多次问答操作后，检查数据库中是否准确记录了每条日志的各项信息；查看热词统计结果，验证是否与实际问题中的高频词汇一致；检查响应时间统计指标是否准确计算。

异常场景：模拟系统在记录日志过程中出现数据库连接失败的情况，查看系统是否有相应的容错机制（如缓存日志，待连接恢复后再写入），且不会影响问

答功能的正常使用。

，边界条件：在短时间内有大量用户进行问答操作，验证系统是否能及时记录所有日志，且统计结果准确无误。

# 3.4.3前端功能设计

# 3.4.3.1智能问答页面 (高优先级)

1．功能点描述：提供用户进行智能问答的界面，包括初始问答页面和对话页面，页面布局和元素参考原型设计。

# 2．交互逻辑

初始问答页面：页面上方显示“上午／下午／晚上好，XXX"（XX×为当前登录用户的姓名）；页面下方是用于输入问题的输入框，输入框右侧有“发送”和“重置”两个按钮。用户在输入框中输入问题后，点击“发送”按钮，页面跳转至对话页面；点击“重置”按钮，输入框中的内容被清空。

对话页面：页面上方显示用户与系统的对话记录，用户的问题和系统的答案依次排列；页面下方同样有输入框和“发送”“重置”按钮。用户可在输入框中继续输入新的问题，点击“发送”后，系统生成答案并添加到对话记录中；点击“重置”，清空当前输入框内容。

# 3．测试要点

页面显示：检查初始页面是否正确显示用户问候语，且用户名是否为当前登录用户；检查两个页面中的输入框、按钮等元素是否齐全、布局是否符合原型。  
·交互操作：在初始页面输入问题并点击“发送”，验证是否能成功跳转至对话页面且问题被正确提交；在对话页面输入新问题并发送，检查系统是否能生成答案并更新对话记录；点击“重置”按钮，验证输入框内容是否被清空。  
·兼容性：在不同浏览器（如Chrome、Firefox、Edge等）和不同分辨率的设备上打开页面，检查页面显示是否正常，功能是否可正常使用。

# 3.5.知识图谱

# 3.5.1功能概述

知识图谱模块用于从已解析的文档中提取实体及实体间关系，构建结构化的知识网络。后端负责知识的提取、存储和推理能力建设，前端负责以图形化方式展示实体关系，为用户提供直观的知识关联视角，辅助理解企业知识体系。

# 3.5.2后端功能设计

# 3.5.2.1图数据库部署 (高优先级)

# 1.\*\*功能点描述\*\*

部署图数据库（如Neo4j、JanusGraph等），搭建知识图谱的数据存储载体，支持实体与关系的高效存储、查询与关联分析。

2.\*\*业务规则\*\*

-图数据库需支持高并发读写，满足至少1000次/秒的查询请求;

-数据库需配置定期备份策略 (每日全量备份 $^ +$ 实时增量备份）；

-需与系统其他模块（如文档解析模块）建立数据接口，接收待处理的文本数据。

# 3.\*\*测试要点\*\*

-\*\*正常场景\*\*:

-验证图数据库是否成功部署并正常启动，服务状态是否稳定;

-执行基础的实体和关系CRUD操作（创建、查询、更新、删除），验证数据库功能是否正常。

-\*\*异常场景\*\*:

-模拟数据库连接失败，检查系统是否有容错机制（如重试机制、错误日志记录）；

-中断备份过程，验证是否能恢复备份任务或使用上次备份数据。

-\*\*性能测试\*\*:

-并发1000次/秒的查询请求，验证响应时间是否≤500ms，无请求超时;

-存储10万级实体和50万级关系，验证查询关联关系的响应速度是否满足要求。

# 3.5.2.2 实体关系抽取 (高优先级)

1.\*\*功能点描述\*\*从文档解析后的文本中提取实体（如企业、产品、人名、术语等）和实体间的关系(如“属于”“发布于”“负责”等）。

# 2.\*\*业务规则\*\*

-支持的实体类型包括：组织（部门、公司）、人员、产品、项目、概念术语、时间、地点等;

-支持的关系类型包括：隶属关系（如“张三属于技术部”）、关联关系（如“产品A关联文档B"）、因果关系（如“因为×所以Y"）等;

-采用“预训练模型 $^ +$ 规则引擎”结合的方式提取：预训练模型（如 ERNIE、BERT-WWM）负责初步识别，规则引擎（基于领域词典）优化提取结果;

-提取结果需包含实体名称、实体类型、关系类型、置信度 $( 0 - 1 0 0 \% )$ ），置信度低于 $60 \%$ 的结果需标记为“待审核”。

# 3.\*\*测试要点\*\*

-\*\*准确率测试\*\*：

-选取100段包含明确实体关系的样本文本（如“技术部的李四负责开发产品

X"），验证实体（技术部、李四、产品×）和关系（隶属、负责）的提取准确率是否$\geqslant 9 0 \%$ ：；，

-检查置信度计算是否合理 (正确提取的结果置信度是否 $\geq 6 0 \%$ ）。

-\*\*召回率测试\*\*:

-选取包含1000个实体和500个关系的复杂文档，验证系统是否能提取出 $\geq 8 5 \%$ 的实体和关系。

-\*\*异常场景\*\*:

-输入无实体关系的纯描述文本（如“今天天气很好”），验证是否无错误提取结果；

-输入包含歧义的文本（如“张三打了李四的报告”），验证是否能通过规则引擎修正提取错误。

# 3.5.2.3 关系提取与图数据库写入 (高优先级)

# 1.\*\*功能点描述\*\*

对提取的实体和关系进行清洗、规范化处理，按照图数据库格式要求写入数据，构建知识图谱。

2.\*\*业务规则\*\*

-实体规范化：同一实体的不同表述需合并（如“AI项目”和“人工智能项目”合并为“人工智能项目”）；

-关系去重：相同实体对之间的同一类型关系仅保留一条记录，更新置信度为最高值;-写入逻辑：采用批量写入模式（每积累1000条实体关系数据执行一次写入），减少数据库交互次数；

-数据关联：实体需关联来源文档ID，支持追溯知识的原始出处。

# 3.\*\*测试要点\*\*

-\*\*数据一致性\*\*:-输入包含重复实体表述的文本，验证图数据库中是否已合并为单一实体;-检查写入的实体关系是否包含来源文档ID，且与原始文档对应正确。

-\*\*性能测试\*\*:

-处理10万条实体关系数据，验证批量写入的平均速度是否≥1000条/秒;

-\*\*异常场景\*\*:

-模拟写入过程中数据库断开连接，验证是否有数据缓存机制，重新连接后可继续写入（无数据丢失）。

# 3.5.2.4知识推理能力 (高优先级)

1.\*\*功能点描述\*\*基于已构建的知识图谱，通过规则推理发现新的实体关系（如从“A属于 $\mathsf { B } ^ { m } \mathsf { B }$ 属于  
C"推理出“A属于C"）。

# 2.\*\*业务规则\*\*

-支持的推理规则包括：传递性推理（如部门隶属关系）、对称性推理（如合作关系）、逆向推理（如“负责”的逆向是“被负责”）；

-推理结果需标记“推理得出”，并记录推理依据（如“根据规则×从关系A和B推理得出”）；

-推理过程定时执行（默认每日凌晨2点），也可手动触发。

# 3.\*\*测试要点\*\*

-\*\*推理准确性\*\*：-构建包含传递性关系的测试数据(如“产品A属于产品线B""产品线B属于部门C"），验证是否能推理出“产品A属于部门C";-检查推理结果是否正确标记来源和依据。

-\*\*性能测试\*\*:

-在包含10万级实体关系的图谱上执行全量推理，验证是否能在1小时内完成。

# 3.5.3前端功能设计

# 3.5.3.1知识图谱前端展示 (低优先级)

1.\*\*功能点描述\*\*

以图形化方式展示知识图谱中的实体及关系，支持交互操作（如缩放、筛选、查看详情）。

# 2.\*\*交互逻辑\*\*

-\*\*图谱展示\*\*：

-实体以节点表示（不同类型实体用不同颜色/形状区分，如组织用蓝色圆形，人员用绿色方形）；

-关系以连接节点的边表示，边上标注关系类型（如“属于”“负责”）；

-\*\*基础操作\*\*:

-鼠标滚轮缩放图谱，拖拽空白区域平移图谱;

-点击实体节点，高亮显示该节点及其直接关联的实体和关系，并在右侧面板显示实体详情（名称、类型、来源文档、相关关系等）；

-\*\*筛选功能\*\*:

-提供实体类型筛选器（如只显示“产品”和“人员”实体）；

-提供关系类型筛选器（如只显示“负责”关系）；

-支持搜索实体名称，定位并高亮显示目标实体。

# 3.\*\*测试要点\*\*

-\*\*展示准确性\*\*：

-对比前端展示的实体关系与图数据库中的数据，验证是否一致（节点数量、关系类型无偏差）；

-检查不同类型实体的样式区分是否清晰。

-\*\*交互操作\*\*:

-测试缩放、平移功能是否流畅，无卡顿;

-点击实体节点，验证是否正确高亮关联元素及显示详情;

-使用筛选器和搜索功能，验证是否能准确过滤和定位实体。

-\*\*性能测试\*\*:

-加载包含1000个实体和5000个关系的图谱，验证页面加载时间是否 $\leqslant 3$ 秒，操作是否流畅。

# 3.6.权限管理与用户管理

# 3.6.1功能概述

权限管理与用户管理模块用于控制系统访问权限及用户信息维护。高优先级功能采用简化设计，通过数据库直接配置固定的用户、角色和权限关系，无需界面操作；低优先级功能提供基础的用户、角色、权限管理界面，支持动态调整。模块核心是通过"用户-角色-权限"关联，结合部门维度，实现系统功能和数据集的访问控制。

针对产研组和公司角色的数据集权限控制逻辑如下：

数据集（即文档解析后形成的知识库）的访问权限与角色--部门强关联，产研组用户仅能访问本部门数据集，公司角色用户可访问所有部门数据集，且该权限控制需贯穿智能问答、知识图谱等依赖数据集的模块。

# 3.6.2后端功能设计

# 3.6.2.1数据集权限控制逻辑 (高优先级)

# 1.\*\*功能点描述\*\*

在原有权限基础上，新增数据集（知识库）的部门级访问控制，确保产研组用户仅能访问本部门数据集，公司角色用户可访问所有数据集。

# 2.\*\*业务规则\*\*

-\*\*数据集与部门关联\*\*：每个数据集（知识库）在创建时需关联"所属部门"（由创

建者所属部门或上传文件时选择的部门决定）；

-\*\*访问权限判定\*\*:

<table><tr><td>用户角色</td><td>数据集访问范围</td><td>判定逻辑</td></tr><tr><td>产研组</td><td>仅本部门数据集</td><td>数据集.所属部门ID=用 户.所属部门ID</td></tr><tr><td>公司</td><td>所有部门数据集</td><td>无部门限制条件</td></tr><tr><td>Admin</td><td>所有部门数据集</td><td>无部门限制条件</td></tr></table>

-\*\*权限穿透场景\*\*:

-智能问答：RAG检索时仅返回用户有权访问的数据集内容;

-知识图谱：实体关系查询时仅返回来源于有权访问数据集的内容;

-文档/知识库管理：台账仅显示有权访问的部门的文档/知识库。

# 3.\*\*测试要点\*\*

# -\*\*智能问答权限验证\*\*：

-准备两个数据集：产研部数据集（含"产品A参数"）、公司数据集（含"产品A定价"）；

-使用产研组用户提问"产品A的信息"，验证答案仅包含"产品A参数"，不包含"产

# 品A定价"；

-使用公司角色用户提问相同问题，验证答案同时包含两个数据集的内容。

# -\*\*知识图谱权限验证\*\*：

-产研部数据集包含实体关系"产品A-属于-产研部";  
-产研组用户查看知识图谱，验证仅能看到"产品A-属于-产研部";  
-公司角色用户查看，验证能看到全部两个关系。

# -\*\*文档上传与归属验证\*\*:

-产研组用户上传文件时选择"产研部"，验证生成的数据集所属部门为产研部;

-公司角色用户上传文件时选择"公司"，验证生成的数据集所属部门为公司，且产研组用户无法访问。

# 3.6.2.2 固定权限配置 (高优先级)

# 1.\*\*功能点描述\*\*

预设3个权限组，对应固定权限范围，通过数据库配置3个用户分别关联权限组，权限与功能的对应关系写死，不提供界面修改入口。

# 2.\*\*业务规则\*\*

-\*\*权限组定义\*\*:

-Admin：拥有系统全部功能的访问权限（所有模块的所有操作）；

-公司（父权限组）：可访问统计看板、智能问答、文档处理（含删除）、知识图谱、权限管理、用户管理模块的全部功能;

-产研组（子权限组）：可访问统计看板、智能问答、知识图谱模块的全部功能，及文档处理模块（不含删除功能）；

-\*\*用户配置\*\*：数据库预先配置3个用户，对应关系为：

|用户名 「对应权限组丨所属部门丨权限说明

![](images/0b519a3b7612024d2d3ca242b8f8c4682e9dfac9eb7b8472a40eaf8388d4ddca.jpg)

丨 sys_admin丨Admin丨系统管理部|全部权限

丨company_admin丨公司丨公司总部丨含文档删除、权限/用户管理权限|

丨rnd_staff丨产研组丨产研部丨无文档删除、无权限/用户管理权限|

-\*\*权限验证逻辑\*\*：所有接口请求需携带用户身份信息，后端通过用户所属权限组判断请求的功能是否允许访问，不匹配则返回"无权限"。

# 3.\*\*测试要点\*\*

-\*\*权限范围验证\*\*：

-使用rnd_staff账号登录，尝试执行文档删除操作，验证是否返回"无权限";

-使用company_admin 账号登录，执行文档删除操作，验证是否允许;  
-使用sys_admin 账号登录，访问任意模块功能，验证是否均能正常操作。

-\*\*数据库配置验证\*\*：

-检查数据库用户表(如'sys_user）是否存在3个预设用户，且'role_id字段正确关联对应权限组;

-检查权限关联表（如'role_permission\`），验证公司权限组是否包含document:delete权限，产研组是否不包含。

-\*\*接口鉴权验证\*\*：

-模拟无权限用户（如修改请求头中的用户信息为不存在的账号）访问任意接口，验证是否返回403错误。

# 3.6.2.3 固定角色管理 (高优先级)

# 1.\*\*功能点描述\*\*

数据库预先配置3个部门，与3个角色一一对应，角色关联的用户和权限写死，不提供界面修改，仅支持数据库直接修改。

# 2.\*\*业务规则\*\*

-\*\*部门与角色对应关系\*\*:

-系统管理部 Admin 角色;

-公司总部 公司角色;

-产研部 产研组角色;

-\*\*角色属性\*\*：每个角色记录包含角色名称、所属部门、权限范围（存储为权限标识集合，如["document:upload","qa:query"T'）;

-\*\*修改限制\*\*：角色的创建、删除、权限调整均不提供界面操作，需直接修改数据库表（如'sys_role\`、‘role_permission'）。

# 3.\*\*测试要点\*\*

-\*\*角色-部门关联验证\*\*：

-检查数据库角色表（如'sys_role），验证3个角色的'dept_id是否正确关联对应的部门；

-\*\*角色-权限关联验证\*\*：  
-检查'role_permission\`表，验证Admin 角色的权限集合是否包含所有功能标识(如["\*"]）；

-\*\*修改生效验证\*\*:

-直接修改数据库，为产研组角色添加'document:delete权限，使用rnd_staff账

号测试文档删除，验证是否生效（允许删除）；-改回权限后，再次测试，验证是否恢复无权限状态。

# 3.6.2.4固定用户管理 (高优先级)

# 1.\*\*功能点描述\*\*

数据库预先配置3个用户，与3个部门、3个角色一一对应，用户信息（工号、姓名、所属部门）写死，不提供界面修改。

# 2.\*\*业务规则\*\*

-\*\*用户属性\*\*：每个用户记录包含工号（唯一）、姓名、所属部门ID、角色ID、创建时间;

-\*\*关联关系\*\*：用户的dept_id关联部门表，role_id关联角色表，通过角色间接关联权限；

-\*\*修改限制\*\*：用户的创建、删除、信息修改均不提供界面操作，需直接修改数据库表（如'sys_user）。

# 3.\*\*测试要点\*\*

-\*\*用户信息验证\*\*:

-检查数据库用户表，验证3个用户的工号、姓名是否正确（如工号分别

为"AD001"、"CO001"、"RD001"）;

-\*\*关联关系验证\*\*：

-检查用户表的dept_id和\`role_id\`，验证是否与对应部门、角色正确关联;

\*\*登录验证\*\*:

-使用3个预设用户的账号密码登录系统，验证是否能成功登录，且登录后显示的所属部门正确。

# 3.6.2.5权限配置 (低优先级)

# 1.\*\*功能点描述\*\*

支持定义角色及其默认权限，允许通过界面动态调整角色的权限范围（在高优先级预设基础上扩展）。

# 2.\*\*业务规则\*\*

-角色默认权限可在创建时设置，后续可通过"权限配置"功能修改;

-权限粒度为"模块 $^ +$ 操作" （如'document:upload\`、document:delete'）;

-调整后的权限实时生效，无需重启系统。

3.\*\*测试要点\*\*

-新建角色并配置默认权限（如仅允许访问智能问答），创建用户关联该角色，验证用户是否只能访问智能问答模块;

-对已有角色调整权限（如移除qa:query），验证关联用户是否无法再使用智能问答功能。

# 3.6.2.6角色管理 (低优先级)

# 1.\*\*功能点描述\*\*

支持角色的创建、删除，及用户与角色的关联管理；开发部门树形结构API，支持递归查询子部门及动态鉴权。

# 2.\*\*业务规则\*\*

-角色创建需指定名称、所属部门、描述;

-角色删除时，若关联用户，需提示"该角色关联×个用户，删除后用户将失去对应权限"，确认后可删除;

-部门支持树形结构 (如公司总部 产研部 前端组），API可返回指定部门的所有子部门（递归查询）。

# 3.\*\*测试要点\*\*

-创建新角色（如"市场部角色"），关联3个用户，验证角色表和用户-角色关联表是

# 否新增记录;

-删除关联了用户的角色，验证是否显示提示，且删除后用户角色字段是否为空;

-调用部门树形结构API，传入"公司总部"，验证是否返回包含产研部等子部门的完整结构。

# 3.6.2.7用户管理 (低优先级)

1.\*\*功能点描述\*\*

支持用户的创建、删除功能，用户信息包括工号、姓名、所属部门、关联角色。

# 2.\*\*业务规则\*\*

-工号为唯一标识，不可重复;

-创建用户时必须指定所属部门和关联角色;

-用户删除为物理删除，删除后所有关联记录（如登录日志）中的用户信息保留但标记为"已删除"。

# 3.\*\*测试要点\*\*

-创建用户（工号"MK001"，姓名"张三"，部门"市场部"，角色"市场部角色"），验证用户表是否新增记录，且关联关系正确；

-尝试创建重复工号的用户，验证是否提示"工号已存在";

-删除用户"MK001"，验证用户表是否移除该记录，且登录日志中该用户的记录是否标记"已删除"。

# 3.6.3前端功能设计

# 3.6.3.1用户管理前端页面 (低优先级)

1.\*\*功能点描述\*\*提供用户管理台账页，支持用户的新建、删除和角色分配操作，包含查询筛选功能。

2.\*\*台账字段与查询条件\*\*

-\*\*台账字段\*\*：工号、姓名、所属部门、关联角色、创建时间;-\*\*查询条件\*\*：姓名（模糊匹配）、工号（精确匹配）、关联角色（下拉选择）、所属部门（下拉选择）、创建时间（日期范围），及"查询""重置"按钮。

# 3.\*\*交互逻辑\*\*

\*\*用户新建\*\*:

1.点击"用户新建"按钮，弹出新建页面;

2.输入工号、姓名，从下拉框选择所属部门和关联角色;

3.点击"确认"，提交后端创建，成功后台账刷新显示新用户。

-\*\*用户删除\*\*:

1.勾选台账中一个或多个用户，点击"用户删除"按钮；

2.弹出确认框（"确定删除选中的×个用户？"）；

3.点击"确认"，提交删除，成功后提示"删除成功"，台账刷新。

-\*\*角色分配\*\*:

1.勾选单个用户，点击"角色分配"按钮，弹出分配对话框;

2.选择新的角色和所属部门（可与原部门不同）；

3.点击"确认"，提交修改，成功后台账中该用户的"关联角色"和"所属部门"字段更新。

# 4.\*\*测试要点\*\*

-\*\*页面布局\*\*：检查台账是否显示所有字段，查询条件是否完整；

-\*\*用户新建\*\*：输入合法信息创建用户，验证台账是否新增记录，且信息正确;

-\*\*用户删除\*\*：删除用户后，验证台账是否移除该记录，且后端用户表是否同步删

# 除；

-\*\*角色分配\*\*：为用户重新分配角色后，使用该用户登录，验证权限是否随新角色变化。

# 3.6.3.2权限管理前端页面 (低优先级)

1.\*\*功能点描述\*\*

提供权限管理台账页，支持角色的新建、删除和权限配置操作，包含查询筛选功能。

# 2.\*\*台账字段与查询条件\*\*

-\*\*台账字段\*\*：序号、角色名称、所属部门、关联用户数、创建时间、状态（启用/禁用）、创建人、备注；

-\*\*查询条件\*\*：角色名称（模糊匹配）、所属部门（下拉选择）、创建时间（日期范围），及"查询""重置"按钮。

# 3.\*\*交互逻辑\*\*

-\*\*角色新建\*\*:

1.点击"角色新建"按钮，跳转至新建页面;

2.输入角色名、角色描述，选择所属部门;

3.页面下方显示用户列表（可通过用户名、工号、部门筛选），勾选需关联该角色的用户；

4.点击"完成"，提交创建，成功后返回台账页，显示新角色。

-\*\*角色删除\*\*:

1.勾选台账中一个或多个角色，点击"角色删除"按钮;

2.若角色关联用户，弹出提示（"选中的×个角色关联了Y个用户，删除后用户将失去对应权限，是否继续？"）；

3.点击"确认"，提交删除，成功后台账刷新。

-\*\*权限配置\*\*:

1.勾选单个角色，点击"权限配置"按钮，跳转至配置页面;

2.选择所属部门（权限范围限定在该部门及子部门）；

3.权限列表以模块分组（如文档管理、智能问答），每个模块下显示可勾选的操作权限（如上传、删除）；

4.勾选权限后点击"完成"，提交配置，成功后权限实时生效。

# 4.\*\*测试要点\*\*

-\*\*角色新建\*\*：创建角色并关联用户，验证台账是否显示新角色，且"关联用户数"正确；

-\*\*角色删除\*\*：删除关联用户的角色，验证是否显示提示，且删除后用户角色是否为空；

-\*\*权限配置\*\*：为角色勾选"文档删除"权限，使用该角色的用户测试文档删除，验

证是否允许操作。

# 3.7.统计看板

# 3.7.1功能概述

统计看板模块通过可视化图表展示系统核心数据指标，帮助用户直观解各部门文档上传情况、文档类型分布、用户查询热词及系统活跃数据。后端负责数据提取、存储与接口开发，前端通过图表直观呈现统计结果，支持数据趋势分析与业务决策。

# 3.7.2后端功能设计

# 3.7.2.1统计看板 SQL和接口 (中优先级)

1.\*\*功能点描述\*\*

设计关系型数据库表存储统计数据，编写SQL查询语句提取关键指标，开发接口向前端提供图表所需数据。

# 2.\*\*业务规则\*\*

-\*\*数据存储\*\*:

-核心统计指标按日聚合存储（如'daily_statistics\`表），包含日期、部门ID、文档类型、上传数量、查询次数等字段；

-热词数据单独存储（如'hot_words'表），包含词项、查询次数、统计日期、环比增长率；

-数据保留周期为1年，超过1年的历史数据自动归档。

-\*\*接口设计\*\*:  
-提供4个专用接口，分别对应前端4个统计图表的数据需求;  
-支持按时间范围筛选（默认显示近30天数据），返回数据格式适配前端图表组件(如折线图需xAxis\`和'series\`数组）。

-\*\*数据更新\*\*:-实时指标（如上传数量、查询次数）采用增量更新（每小时同步一次）；-离线指标（如热词增长率、召回率）每日凌晨2点全量计算更新。

# 3.\*\*核心 SQL示例\*\*

-各部门上传文档数量趋势:   
"sql   
SELECT dept_name, upload_date, SUM(file_count) AS total   
FROM daily_statistics   
WHERE upload_date BETWEEN ? AND ?   
GROUP BY dept_name, upload_date   
ORDER BY upload_date,dept_name   
三

-文档类型分布:"\`sql

SELECT file_ext, COUNT(\*) AS count, SUM(CASE WHEN recall_status $=$ 'recalled' THEN 1 ELSE0 END)/COUNT(\*) AS recallrate FROM document_info GROUP BY file_ext

4.\*\*测试要点\*\*-\*\*接口数据准确性\*\*：

-手动上传10个文档（5个docx、3个pdf、2个txt，分属2个部门），调用文档类型分布接口，验证返回的数量和百分比是否正确;

-模拟100次查询（含20次"产品"、15次"定价"），调用热词接口，验证TOP8热词是否包含这两个词且次数正确。

-\*\*权限过滤验证\*\*:

-使用产研组用户调用部门趋势接口，验证是否仅返回产研部数据;  
-使用公司角色用户调用，验证返回所有部门数据。

-\*\*性能测试\*\*:-调用包含1年历史数据的接口，验证响应时间是否 $\leqslant 1$ 秒；-并发100次接口请求，验证是否无数据错乱或超时。

# 3.7.3前端功能设计

# 3.7.3.1统计看板前端页面 (中优先级)

1.\*\*页面布局\*\*

单页面包含4个统计区域，从上到下、从左到右依次排列：

-区域1：各部门上传文档数量趋势统计图 (折线图)

-区域2：文档类型分布 (环形图)

-区域3：热词查询统计（TOP8列表 $+$ 增长率标识)

-区域4：用户活跃概览（总览 $^ +$ 分部门数据卡片)

2.\*\*各区域详细设计\*\*

-\*\*区域1：部门上传趋势折线图\*\*

-图表类型：多折线图 (每个部门一条折线)

-X轴：日期 (如近30天，格式"MM-DD")

-Y轴：上传文件数量

-交互：鼠标悬停在折线上的点，显示具体日期 $+$ 部门 $^ +$ 数量（如"2024-08-15产研

部：12个")

-筛选器：页面上方提供时间范围选择 (近7天/近30天/近90天)

-\*\*区域2：文档类型分布环形图\*\*

-主图表：环形图，按文件扩展名（txt、pdf、docx等）划分扇区，扇区面积对应占比，显示扩展名 $^ +$ 百分比(如"docx: $3 5 \% "$ ）

-交互：鼠标悬停在某一扇区（如pdf），下方自动显示该类型文档的召回率子环形图（两个扇区："已召回: $80 \% "$ 、"未召回: $2 0 \% "$

-样式：主环形图直径 $3 0 0 { \mathsf { p } } \times$ ，子环形图直径 $1 5 0 \mathsf { p } \mathsf { x }$ ，颜色区分明显（如docx蓝色、 pdf绿色)

-\*\*区域3：热词查询统计\*\*

-展示形式：横向条形图 $^ +$ 文本标识，共8项 (TOP1到TOP8)

-内容：热词名称、查询次数（条形长度对应次数多少）、增长率（如 $" + 2 5 \%$ 用绿色向上箭头，"-10%"用红色向下箭头)

-交互：点击热词可跳转到智能问答页面，自动填充该热词为查询内容

-\*\*区域4：用户活跃概览\*\*

-总览部分：3个数据卡片，分别显示"总查询次数"、"总文档上传数"、"总召回比例"(大字体数字 $^ +$ 图标)

-分部门部分：表格形式，字段包括部门名称、查询次数、上传文档数、召回比例

(如"产研部 520次120个 $8 5 \% " .$

-排序：支持点击表格表头按字段排序 (如按"查询次数"降序)

# 3.\*\*交互逻辑\*\*

-页面加载时自动请求后端4个接口，加载数据时显示骨架屏;

-数据加载失败时，每个区域显示"加载失败，点击重试"按钮;

-时间范围筛选器变更时，所有依赖时间的图表（区域1、区域3）自动重新请求数据并刷新;

-权限控制：产研组用户查看区域4分部门数据时，仅显示产研部信息。

# 4.\*\*测试要点\*\*

-\*\*图表渲染准确性\*\*:

-验证折线图的折线走势是否与实际数据一致（如某部门某天上传5个文档，对应点是否在 $\mathsf { Y } { = } 5$ 位置）；

-检查环形图各扇区占比之和是否为 $100 \%$ ，子环形图召回率计算是否正确（已召回数/总数量）。

-\*\*交互功能验证\*\*:

-鼠标悬停在环形图扇区，验证子环形图是否正确显示该类型的召回率;  
-点击热词，验证是否跳转到智能问答页面且自动填充该词。

-\*\*权限与兼容性\*\*:

-使用产研组用户登录，验证区域4分部门表格是否仅显示产研部数据;

-在不同分辨率屏幕上查看，验证图表是否自适应缩放（无内容溢出或显示不全）。

-在不同浏览器测试兼容性。

# 3.8.系统运维

# 3.8.1功能概述

系统运维模块用于监控系统核心组件的运行状态及智能问答模型的质量表现。通过实时检测数据库、API服务的可用性及存储空间，结合模型评估指标的可视化展示，帮助管理员及时发现系统异常并进行维护，保障系统稳定运行。

# 3.8.2后端功能设计

# 3.8.2.1系统状态监控 (中优先级)

1．功能点：获取关系数据库、向量数据库、图数据库的运行状态，API服务运行状态，存储空间剩余量，按规则判断系统整体状态。

# 2．业务规则:

# 监控对象及判断标准：

03种数据库：通过连接／心跳检测判断“运行中”或“停止”；  
。API服务：通过健康检查接口判断“正常”或“异常”；  
。存储空间：计算剩余容量占比（剩余容量／总容量）；

# 。系统状态判断：

。正常（绿点）：3种数据库均运行中 $^ +$ API服务正常 $^ +$ 存储空间剩余占比 ${ < } 6 0 \%$ ·，  
0异常（红点）：上述任意条件不满足。

# 。数据每30秒自动刷新一次。

# 3．测试要点:

。正常场景：3种数据库、API均正常，存储空间剩余 $5 0 \%$ ，验证系统显示“正常（绿点）”；  
0异常场景:0停止向量数据库，其他正常，验证显示“异常（红点）”；。所有组件正常，但存储空间剩余 $6 0 \%$ ，验证显示“异常（红点）”；

。刷新验证：系统从异常恢复正常后，30秒内是否自动更新状态。

# 3.8.2.2模型质量监控 (中优先级)

1．功能点：接收评估问题和标准答案，生成模型答案后计算4项指标 (忠实度、答案相关性、上下文精确度、上下文召回率），返回用于绘制柱状图的数据。

# 2．业务规则:

。指标定义（0-100分，越高越好）：

0忠实度：答案与知识库内容的一致性；  
。答案相关性：答案与评估问题的匹配度;  
0上下文精确度：检索片段与问题的相关程度;  
0上下文召回率：检索片段覆盖标准答案关键信息的比例;

。基于输入的问题和标准答案，调用模型生成答案后，通过文本匹配、关键词覆盖度计算指标。

# 3．测试要点:

0正常场景：输入问题“产品A定价”、标准答案“100元”，模型答案“产品A价格100元”，验证4项指标均≥90分；  
0异常场景：模型答案为“产品B定价100元”（与问题无关），验证“答案相关性”≤30分；。兼容性：输入超长问题（500字）和标准答案，验证接口是否正常返回

指标。

# 3.8.2.3 Langfuse 中使用 RAGAS 持续监控 (低优先级)

1．功能点：集成 Langfuse平台与 RAGAS 框架，自动抽取问答日志样本，持续监控模型质量并记录数据。

# 2．业务规则:

。每小时从实际日志中抽取10条样本（问题 $^ +$ 答案 $^ +$ 上下文）；  
。调用 RAGAS 计算4项指标，结果同步至Langfuse;  
。某指标连续3次低于阈值（如忠实度<70分），触发告警日志。

# 3．测试要点:

0检查每小时是否自动生成10 条样本的评估记录;  
0模拟指标连续异常，验证是否生成告警日志。

# 3.8.3前端功能设计

# 3.8.3.1系统运维前端页面 (中优先级)

1．页面布局：单页面分上下两部分，上半部分为系统状态监控区，下半部分为模型质量监控区。

# 2．系统状态监控区：

。标题：“系统运行状态”；  
。整体状态：顶部显示大尺寸圆点（绿色 $=$ 正常，红色 $=$ 异常），旁附文字说明；  
。组件状态列表：

<table><tr><td>组件名称</td><td>状态展示 (文字+图标)</td><td>补充信息</td></tr><tr><td>关系数据库</td><td>运行中（√绿色）/停止（×红 色</td><td></td></tr><tr><td>向量数据库</td><td>运行中（√绿色）/停止（×红 色</td><td></td></tr><tr><td>图数据库</td><td>运行中（√绿色）/停止（×红 色</td><td></td></tr><tr><td>API服务</td><td>正常（√绿色）/异常（×红 色</td><td></td></tr><tr><td>存储空间</td><td>剩余XX GB (XX%)</td><td>总容量xx GB</td></tr></table>

○操作：手动刷新按钮（默认自动刷新）。

# 3．模型质量监控区：

0标题：“模型质量评估”；。输入区域：评估问题输入框、标准答案输入框、“提交评估”按钮;。结果展示区：柱状图（×轴为4项指标，Y轴为得分，柱子顶部显示具体分数）；无数据时提示“请输入评估内容并提交”。

# 4．交互逻辑:

0页面加载后自动请求系统状态数据，每30秒自动刷新；。模型评估：输入内容后点击“提交评估”，显示“评估中..."”，完成后渲染柱状图；可多次提交，覆盖之前结果。

# 5．测试要点：

0系统状态展示：模拟正常／异常场景，验证圆点颜色、文字说明及组件状态是否正确；  
。模型评估交互：输入内容提交后，验证是否显示评估过程及最终柱状图;输入空问题时是否提示“请输入评估问题”；  
。兼容性：不同浏览器／分辨率下页面是否正常显示，无样式错乱。

# 四、完整功能清单（详见《story》）

# 五、验收标准

# 5.1.功能验收标准

# 1.用户登录模块

<table><tr><td>验收内容</td><td>验收标准</td></tr><tr><td rowspan="4">登录功能</td><td>1.输入正确用户名/密码，100%成功登录并跳转至首页；</td></tr><tr><td>2.输入错误信息，100%提示“用户名或密码错误”；</td></tr><tr><td>3.连续5次登录失败后，账户被锁定30分钟，期间登录提示</td></tr><tr><td>“账户已锁定”。</td></tr><tr><td rowspan="2">认证与token 管理</td><td>1.登录成功后生成有效 token，有效期内（默认2小时）可</td></tr><tr><td>正常访问系统; 2.token过期后访问系统，自动跳转至登录页。</td></tr><tr><td rowspan="2">登录日志</td><td>1.成功/失败登录均记录用户名、时间，日志100%准确;</td></tr><tr><td>2.记录登录设备、IP，异地登录（与历史IP 地区不符）时， 后台用户触发二次验证（如验证码）。</td></tr></table>

<table><tr><td>验收内容</td><td>验收标准</td></tr><tr><td rowspan="5">密码功能</td><td>1.密码需包含大小写、特殊字符（8-16位），不符合时</td></tr><tr><td>100%提示“密码过于简单”；</td></tr><tr><td>2.勾选“记住密码”后，30天内（可配置）自动填充用户</td></tr><tr><td>名/密码。</td></tr><tr><td></td></tr></table>

# 2.文档管理模块

<table><tr><td>验收内 容</td><td>验收标准</td></tr><tr><td></td><td>1.支持 txt/pdf/docx/csv/markdown（高优先级）及7种低优先</td></tr><tr><td>文件上</td><td>级格式，符合格式的文件100%可上传；</td></tr><tr><td>传</td><td>2.单个文件≤15MB可上传，超过15MB时100% 提示“文件过</td></tr><tr><td></td><td>大”；</td></tr><tr><td></td><td>3.支持拖拽上传和路径选择上传，两种方式均100% 有效。</td></tr><tr><td>文件接</td><td>1.≥5MB文件自动分片上传，合并后与原文件一致性100%;</td></tr><tr><td>收与解</td><td>2.解析后自动去除页眉/页脚/页码，特殊字符清理率100%;</td></tr><tr><td>析</td><td>3.中文BERT分词准确率≥95%，Milvus向量转换成功且可用于检</td></tr></table>

<table><tr><td>验收内 容</td><td>验收标准</td></tr><tr><td></td><td>索。</td></tr><tr><td>文档管</td><td>1.台账字段（序号/名称/部门/字符数/状态等）100% 完整显 示；</td></tr><tr><td>理台账</td><td>2.按名称／部门/时间筛选，结果与筛选条件匹配度100%;</td></tr><tr><td rowspan="2">文档删 除</td><td>3.分页功能正常（默认20条／页），无数据遗漏。</td></tr><tr><td>1.有权限用户（Admin／公司角色）删除后，文件及关联数据 (向量/元数据）100%清除;</td></tr></table>

# 3.知识库管理模块

<table><tr><td>验收内容</td><td>验收标准</td></tr><tr><td>知识库创建</td><td>1.创建时名称+部门必填，同一部门名称不重复，100% 校</td></tr><tr><td>与发布</td><td>验；</td></tr></table>

<table><tr><td colspan="2"></td></tr><tr><td>验收内容</td><td>验收标准</td></tr><tr><td>文档添加与 删除</td><td>1.向知识库添加文档时，部门与知识库一致，不一致时100% 提示“部门不匹配”； 2.删除知识库时，含文档则提示“含×个文档，删除将级联删</td></tr><tr><td>知识库台账 4.智能问答模块</td><td>1.台账字段（名称/部门/文件数/状态等）100%完整; 2.点击知识库名称，跳转至详情页且数据准确。</td></tr><tr><td>验收内 容</td><td>验收标准</td></tr><tr><td>问答功 能 权限控</td><td>1.用户输入问题后，RAG 检索相关文档片段准确率≥90%; 2.结合知识图谱生成答案，答案与知识库内容一致性 (忠实度) ≥90%； 3.无相关信息时，100%提示“未找到相关内容”。 1.产研组用户仅能获取本部门知识库的答案，100%无跨部门数据</td></tr></table>

<table><tr><td>验收内 容</td><td>验收标准</td></tr><tr><td>制</td><td>泄露；</td></tr><tr><td></td><td>2.公司／Admin 角色可获取所有部门数据，结果完整。</td></tr><tr><td>日志统</td><td>1.记录问题、答案、响应时间，日志100%完整;</td></tr><tr><td>计</td><td>2.热词统计（TOP8）与实际查询频率匹配度≥95%。</td></tr></table>

# 5.知识图谱模块

<table><tr><td>验收内容</td><td>验收标准</td></tr><tr><td>实体关系提</td><td>1.从文档中提取实体（组织/人员/产品等）准确率≥85%;</td></tr><tr><td>取</td><td>2.提取关系（隶属/负责等）准确率≥80%，置信度≥60% 的记录入库。</td></tr><tr><td></td><td>1.图数据库部署成功，实体/关系存储100%准确;</td></tr><tr><td>图数据库与</td><td>2.推理规则（如A属于B，B属于C→A属于C）执行准确率</td></tr><tr><td>推理</td><td>≥90%。</td></tr></table>

<table><tr><td>验收内容</td><td>验收标准</td></tr><tr><td>前端展示</td><td>1.实体（节点）与关系（边）展示与数据库一致，无遗漏; 2.支持缩放、筛选、搜索，操作响应率100%。</td></tr></table>

# 6.权限管理与用户管理模块

<table><tr><td>验收内容</td><td>验收标准</td></tr><tr><td rowspan="5">权限控制</td><td>1.Admin角色拥有全部权限，操作无限制;</td></tr><tr><td>2.公司角色可访问所有部门数据，含文档删除、权限管理功能；</td></tr><tr><td>3.产研组角色仅访问本部门数据，无文档删除、权限管理功能;</td></tr><tr><td>4.权限校验100%生效，无越权操作。</td></tr><tr><td>1.数据库预设3个用户（Admin／公司／产研组），登录及权限</td></tr><tr><td rowspan="2">用户与角 色</td><td>匹配100%正确；</td></tr><tr><td>2.低优先级用户管理页面支持增删改，操作后数据库同步更新。</td></tr></table>

# 7.统计看板模块

<table><tr><td>验收内 容</td><td>验收标准</td></tr><tr><td></td><td>1.部门上传趋势图：数据与实际上传记录匹配度100%;</td></tr><tr><td>统计图</td><td>2.文档类型环形图：占比计算准确，子图（召回率）数据正确;</td></tr><tr><td>表</td><td>3.热词统计：TOP8 热词与查询日志一致，增长率计算准确;</td></tr><tr><td></td><td>4.用户活跃概览：总查询／上传数与实际日志匹配度100%。</td></tr><tr><td>权限过</td><td>1.产研组用户仅查看本部门统计数据，无跨部门信息;</td></tr><tr><td>滤</td><td>2.公司／Admin角色查看所有部门数据，完整无遗漏。</td></tr></table>

# 8.系统运维模块

<table><tr><td>验收内 空容</td><td>验收标准</td></tr><tr><td>系统状</td><td>1.3种数据库+API服务均运行，且存储剩余&lt;60%→绿点（正 常），否则红点（异常），判断准确率100%;</td></tr><tr><td>态监控</td><td>2.每30秒自动刷新状态，数据实时性100%。</td></tr><tr><td>模型质</td><td>1.输入评估问题和标准答案后，4项指标（忠实度等）计算准确率</td></tr></table>

<table><tr><td>验收内 容</td><td>验收标准</td></tr><tr><td>量监控</td><td>≥90%； 2.柱状图展示与指标数据一致，无偏差。</td></tr></table>

# 5.2.性能验收标准

<table><tr><td>验收维度</td><td>验收标准</td></tr><tr><td rowspan="5">响应时间</td><td>1.用户登录：≤2秒;</td></tr><tr><td>2.文档上传(15MB）：≤30秒;</td></tr><tr><td>3.智能问答：单轮问答响应≤5秒;</td></tr><tr><td>4.统计看板加载：≤3秒;</td></tr><tr><td>5.页面跳转：≤1秒。</td></tr><tr><td rowspan="4" colspan="2">并发处理</td><td>1.同时在线用户：≥50人;</td></tr><tr><td>2.并发文件上传（5MB/个）：≥10人;</td></tr><tr><td>3.并发问答请求：≥20次／秒，无超时或数据错乱。</td></tr><tr><td></td></tr></table>

<table><tr><td>验收维度</td><td>验收标准</td></tr><tr><td rowspan="4">数据容量</td><td>1.支持文档总数：≥1000个;</td></tr><tr><td>2.单个知识库文件数：≥200个;</td></tr><tr><td>3.知识图谱实体数：≥10000个，关系数：≥50000 个。</td></tr><tr><td>1.连续运行72小时无崩溃；</td></tr><tr><td rowspan="2">稳定性</td><td>2.文件上传/问答请求成功率：≥99.5%;</td></tr><tr><td>3.数据库连接异常时，系统自动重试，恢复后数据一致。</td></tr></table>

# 5.3.数据验收标准

<table><tr><td>验收维度</td><td>验收标准</td></tr><tr><td></td><td>1.文档解析后文本与原文件关键信息匹配度≥98%;</td></tr><tr><td>数据准确</td><td>2.向量数据与文本内容关联准确率100%;</td></tr><tr><td>性</td><td>3.知识图谱实体/关系与文档内容一致性≥90%;</td></tr><tr><td></td><td>4.统计数据（上传数/查询数等）与实际日志误差≤1%。</td></tr><tr><td>数据完整</td><td>1.文档元数据（名称/大小/部门等）100% 完整存储;</td></tr></table>

<table><tr><td>验收维度</td><td>验收标准</td></tr><tr><td rowspan="2">性</td><td>2.登录日志、操作日志无缺失，覆盖率100%;</td></tr><tr><td>3.知识库删除时，关联文档数据100% 清除，无残留。</td></tr><tr><td rowspan="2">数据一致</td><td>1.关系库、向量库、图数据库中关联数据（如文档ID）100%</td></tr><tr><td>匹配； 2.前端展示数据与后端存储数据一致，无偏差；</td></tr><tr><td rowspan="2">性</td><td>3.权限过滤后的数据（如产研组仅见本部门）100%准确。</td></tr><tr><td></td></tr><tr><td>数据安全</td><td>1.用户密码加密存储（如MD5+盐值），无明文泄露; 2.敏感操作（删除／权限修改）日志100% 记录，可追溯;</td></tr><tr><td>性</td><td>3.数据库每日备份，备份文件可恢复，恢复后数据完整。</td></tr></table>

# 5.4.用户体验标准

<table><tr><td>验收维度</td><td>验收标准</td></tr><tr><td>界面设计</td><td>1.所有页面布局与原型一致，元素（按钮/输入框/图表）无缺 失；</td></tr></table>

<table><tr><td colspan="2"></td></tr><tr><td>验收维度</td><td>验收标准</td></tr><tr><td rowspan="7">操作流程</td><td>2.颜色符合设计（如登录页背景RGB129,211,248），字体清</td></tr><tr><td>晰； 3.响应式设计：在1366×768、1920×1080分辨率下显示正常。</td></tr><tr><td>1.核心流程（登录→上传→问答）步骤≤3步完成，无冗余操</td></tr><tr><td>作；</td></tr><tr><td>2.按钮点击、文件拖拽等交互100%响应，无卡顿;</td></tr><tr><td>3.分页、筛选、搜索等功能入口明显，操作逻辑直观。</td></tr><tr><td>1.错误提示（如“文件过大”“无权限”）清晰易懂，准确率</td></tr><tr><td>容错与提 示</td><td>100%； 2.操作失误（如未填必填项）时，实时提示，不中断流程;</td></tr><tr><td></td><td>3.加载状态显示进度条或“加载中”提示，无空白等待。</td></tr><tr><td rowspan="3">兼容性</td><td>1.支持 Chrome 90+、Firefox 88+、Edge 90+ 浏览器，功能无</td></tr><tr><td>差异；</td></tr><tr><td>2.Windows 10/11、macOS12+系统下运行正常。</td></tr></table>